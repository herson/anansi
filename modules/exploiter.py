import subprocess
import logging

class Exploiter:
    def __init__(self, vulnerabilities):
        self.vulnerabilities = vulnerabilities

    def exploit(self):
        if config['default']['metasploit_enabled']:
            print("Attempting exploitation with Metasploit...")
            for port, service_info in self.vulnerabilities.items():
                try:
                    exploit_command = f"msfconsole -x 'use exploit/multi/handler; set payload {service_info['service']}; run'"
                    subprocess.run(exploit_command, shell=True, check=True)
                except subprocess.CalledProcessError as e:
                    logging.error("Failed to exploit service on port %s: %s", port, e)
        else:
            print("Metasploit is disabled in config.")
        return self.vulnerabilities